<!DOCTYPE html>
<head>
    {% load static %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>医疗管理系统</title>
    <!-- load stylesheets -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400">   <!-- Google web font "Open Sans", https://fonts.google.com/ -->
    <link rel="stylesheet" href="{% static 'font-awesome-4.6.3/css/font-awesome.min.css' %}">           <!-- Font Awesome, http://fontawesome.io/ -->
    <link rel="stylesheet" href="{% static  'css/bootstrap.min.css' %}">                                 <!-- Bootstrap style, http://v4-alpha.getbootstrap.com/ -->
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">                                <!-- Magnific pop up style, http://dimsemenov.com/plugins/magnific-popup/ -->
    <link rel="stylesheet" href="{% static 'css/templatemo-style.css' %}">                              <!-- Templatemo style -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
          <![endif]-->
      </head>

      <body>
          <nav class="navbar navbar-default">
        <img alt="Brand" class="navbar-brand" style="padding: 0" height="50" src="{% static 'img/logo.jpg' %}">
        <a class="navbar-brand" href="#">抖抖医疗管理系统</a>
{#        <ul class="nav navbar-nav" style="padding-right: 377px">#}
{#            {% if loginbean.role == 0 %}#}
{#                <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/adminhome/">管理员中心</a>#}
{#            {% elif loginbean.role == 1 or loginbean.role == 2 %}#}
{#                <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/usershome/">个人中心</a>#}
{#            {% elif loginbean.role == 3 %}#}
{#                <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/doctorhome/">医生中心</a>#}
{#            {% endif %}#}
{#        </ul>#}

        <div  style="padding-left: 899px;margin-top: -7px">
{#        {% if loginbean == None %}#}
{#            <ul class="nav navbar-nav navbar-right">#}
{#                <button class="btn btn-primary btn-lg" data-toggle="modal" onclick="zhucepanel()">注册</button>#}
{#                <button class="btn btn-primary btn-lg" data-toggle="modal" onclick="popLogin()">登陆</button>#}
{#            </ul>#}
{#        {% else %}#}
            <ul class="nav navbar-nav navbar-right">
{#                {% if loginbean.role == 1 or loginbean.role == 2 %}#}
                    <button class="btn btn-primary" type="button" onclick="seemessages()">
                        Messages <span class="badge">{{ loginbean.msgnum }}</span>
                    </button>
                    您好！：{{ loginbean.nicheng }}
                    <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/loginout/">注销</a>
{#                {% elif loginbean.role == 0 %}#}
{#                    <button class="btn btn-primary" type="button" onclick="seemessagesiomp()">#}
{#                        Messages <span class="badge">{{ loginbean.msgnum }}</span>#}
{#                    </button>#}
{#                    您好！：{{ loginbean.nicheng }}#}
{#                    <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/loginout/">注销</a>#}
{#                {% elif loginbean.role == 3 %}#}
{#                    您好！：{{ loginbean.nicheng }}#}
{#                    <a class="btn btn-primary btn-lg" data-toggle="modal" href="/system/loginout/">注销</a>#}
{#                {% endif %}#}
            </ul>
{#        {% endif %}#}
        </div>


    </nav>



        <div class="container-fluid">

            <section id="welcome" class="tm-content-box tm-banner margin-b-10">
                <div class="tm-banner-inner">
                    <h1 class="tm-banner-title">欢迎使用医疗系统</h1>
                </div>
            </section>

            <div class="tm-body">
                <div class="tm-sidebar">
                    <nav class="tm-main-nav">
                        <ul class="tm-main-nav-ul">
                            <li class="tm-nav-item"><a href="#welcome" class="tm-nav-item-link tm-button">
                                <i class="fa fa-smile-o tm-nav-fa"></i>欢迎您</a>
                            </li>
                            <li class="tm-nav-item"><a href="#gallery" class="tm-nav-item-link tm-button">
                                <i class="fa fa-image tm-nav-fa"></i>预约挂号</a>
                            </li>
                            <li class="tm-nav-item"><a href="#services" class="tm-nav-item-link tm-button">
                                <i class="fa fa-tasks tm-nav-fa"></i>医嘱</a>
                            </li>
                            <li class="tm-nav-item"><a href="#about" class="tm-nav-item-link tm-button">
                                <i class="fa fa-sitemap tm-nav-fa"></i>缴费</a>
                            </li>
                            <li class="tm-nav-item"><a href="#contact" class="tm-nav-item-link tm-button">
                                <i class="fa fa-envelope-o tm-nav-fa"></i>医生申请</a>
                            </li>
                        </ul>
                    </nav>
                </div>

                <div class="tm-main-content">

                    <div class="tm-content-box tm-content-box-home">
                        <img src="{% static 'img/1.jpg' %}" alt="Image 1" class="img-fluid tm-welcome-img">
                        <div class="tm-welcome-boxes-container">
                            <div class="tm-welcome-box">
                                <div class="tm-welcome-text">
                                    <h2 class="tm-section-title">我们的宗旨</h2>
                                    <p>为您尽职尽责，贴心暖心的治疗体验。</p>
                                </div>
                                <a href="#" class="tm-welcome-link tm-button">早日康复 身体健康</a>
                            </div>
                            <div class="tm-welcome-box">
                                <div class="tm-welcome-text">
                                    <h2 class="tm-section-title">圣人之训</h2>
                                    <p>天有盈虚,人有屯危,不自慎不能济也。故养性必知足自慎。 --孙思邈</p>
                                </div>
                                <a href="/system/novel/" class="tm-welcome-link tm-button">回到首页</a>
                            </div>
                        </div>
                    </div>


                    <div id="gallery" class="tm-banner-inner">
                        <div class="tm-banner-title" align="center" style="float: left;padding-left:85px">
                            <select id="test" onchange="showName()">
                                <option value="0">-- 选择科室--</option>
                                <option value="内科">内科</option>
                                <option value="外科">外科</option>
                                <option value="儿科">儿科</option>
                                <option value="眼科" id="4">眼科</option>
                                <option value="耳喉鼻科" id="5">耳喉鼻科</option>
                                <option value="口腔科" id="6">口腔科</option>
                                <option value="皮肤科" id="7">皮肤科</option>
                                <option value="中医科" id="8">中医科</option>
                            </select>
                            <input type="text" id="val" readonly="readonly">
                            <input type="button" value="预约" onclick="reg()">
                        </div>
                    </div>

                    <div id="services" class="tm-content-box tm-gray-bg tm-services">

                        <div class="tm-services-img-container">
                            <img src="{% static 'img/3.jpg' %}" alt="Green Field" class="img-fluid tm-services-img">
                        </div>

                        <div class="tm-box-pad tm-services-description-container">
                            <h2 class="tm-section-title">在这里查看您的医嘱</h2>
                            <p class="tm-section-description">当您挂号后我们的管理员会为您选择目前不繁忙的医生，我们的医生拥有业界最高水平，让您没有后顾之忧。当完成诊断后，您可以在这里查看您的医嘱！快捷！方便！</p>
                        <p class="tm-section-description">When you register, our administrator will choose the currently not busy doctor for you, our doctor has the highest level in the industry, let you have no worries.When the diagnosis is complete, you can check your doctor's advice here!Quick!Convenient!</p>
                            <table class="table table-striped">
                                <tr>
                                    <td>
                                        医生
                                    </td>
                                    <td>
                                        编写时间
                                    </td>
                                    <td>
                                        查看
                                    </td>
                                </tr>
                                <tr>
                                    {% if rs.docname == None %}
                                        <td>等待医生分配医生</td>
                                        <td>待医生编写后显示时间</td>
                                    {% else %}
                                        <td>{{ rs.docname }}</td>
                                        <td>{{ rs.createtime }}</td>
                                    {% endif %}
                                    <td>
                                        {% if rs == None %}
                                            请先预约
                                        {% else %}
                                            <button type="button" class="btn btn-primary tm-button" data-toggle="modal"
                                                    data-target="#myModal">查看医嘱
                                            </button>
                                        {% endif %}
                                    </td>
                                </tr>

                            </table>

{#                            <p class="tm-section-description">Nulla id ornare eros, at efficitur risus. Fusce sodales lorem magna, id tempor justo mattis eget. Aenean accumsan semper commodo. Aliquam ante sapien, tincidunt sed vaius et, luctus condimentum sapien.</p>#}
                        </div>

                    </div>

                    <!-- slider -->
                    <div id="about" class="tm-content-box">
                        <div class="tm-box-pad tm-bordered-box">
                            <h2 class="tm-section-title">最快捷的支付速度</h2>
                            <p>为您提供最快捷的支付方法，二维码付款。掏出手机打开微信，就可以完成付款！</p>
                            <table class="table table-striped">
                                <tr>
                                    <td> 代缴金额</td>
                                    <td>缴费</td>
                                </tr>
                                <tr>
                                    <td>
                                        {{ rs.money }}元
                                    </td>
                                    <td>
                                        <button type="button" class="tm-button tm-button-normal" data-toggle="modal"
                                                data-target="#myModal1">
                                            扫码缴费
                                        </button>
                                    </td>
                                </tr>
                            </table>

                        </div>
                        <div class="tm-flex">
                            <div class="tm-purple-bg tm-box-pad tm-bordered-box tm-no-border-top">
                                <h2 class="tm-section-title">人性化的支付体验</h2>
                                <p>本医疗系统由管理员通知您的缴费金额，您只需点击按钮，就可以快速完成付费。</p>
                                <p>This medical system is notified by the administrator of your payment amount. You can quickly complete the payment by clicking the button.</p>
                            </div>
                            <div class="tm-gray-bg tm-box-pad tm-bordered-box tm-no-border-top">
                                <h2 class="tm-section-title">快捷支付</h2>
                                <p>一台手机，一个微信，就可以完成。扫一扫，完成付款，不用您在窗口奔波付款。节约治疗黄金时间</p>
                                <p>A cell phone, a WeChat, can be done.Scan, complete payment, do not need you to travel through the window to pay.Save time for gold.</p>
                            </div>
                        </div>
                    </div>

                    <section id="contact" class="tm-content-box">

                        <div class="tm-flex">
                            <div class="tm-contact-left-half tm-gray-bg">
                                <div class="tm-contact-inner-pad">
                                    <h2 class="tm-section-title">提交您的申请</h2>
                                    {% if loginbean.role == 1 %}
                                        <form action="/system/SubmitMessages/" method="post" class="contact-form"
                                              enctype="multipart/form-data"> {# enctype:上传文件必须要的属性 #}

                                            <div class="form-group">
                                                <input type="text" id="contact_name" name="name" class="form-control"
                                                       placeholder="姓名" required/>
                                            </div>
                                            <div class="form-group">
                                                <input type="email" id="contact_email" name="email" class="form-control"
                                                       placeholder="邮箱" required/>
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputoffice">科室</label>
                                                <select id="applyoffice" onchange="getoffice()">
                                                    <option value="0">-- 选择科室--</option>
                                                    <option value="内科">内科</option>
                                                    <option value="外科">外科</option>
                                                    <option value="儿科">儿科</option>
                                                    <option value="眼科" id="4">眼科</option>
                                                    <option value="耳喉鼻科" id="5">耳喉鼻科</option>
                                                    <option value="口腔科" id="6">口腔科</option>
                                                    <option value="皮肤科" id="7">皮肤科</option>
                                                    <option value="中医科" id="8">中医科</option>
                                                </select>
                                                <input type="text" id="officename" readonly="readonly" name="office">
                                            </div>
                                            <div class="form-group">
                                                <label for="exampleInputFile">上传身份证与行医资格证</label>
                                                <input type="file" id="exampleInputFile1" name="idperson1"
                                                       onchange="xmTanUploadImg(this)" accept="image/*">
                                                <img id="xmTanImg" width="300px" height="300px"/>
                                                <input type="file" id="exampleInputFile2" name="idperson2"
                                                       onchange="xmTanUploadImg1(this)" accept="image/*">
                                                <img id="xmTanImg1" width="300px" height="300px"/><br>
                                                <p class="help-block">注：要求图像清晰可见</p>
                                            </div>

                                            <input type="submit"
                                                   class="btn btn-primary pull-xs-right tm-button tm-button-normal">

                                            {% csrf_token %}
                                        </form>
                                    {% elif loginbean.role == 2 %}
                                        <h1>正在审核中。。。。</h1>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="tm-contact-right-half tm-purple-bg">
                                <div class="tm-address-box">
                                    <h2 class="tm-section-title">此功能说明</h2>
                                    <address>此功能为申请医生功能，<br>
                                             当您申请完成后由管理员审核，<br>
                                             审核通过后方可成为医生。
                                    </address>
                                </div>

                            </div>
                        </div>

                    </section>

                    <footer class="tm-footer">
                        <p class="text-xs-center">作者 &copy; 2018 孙兴 |  <a  target="_blank" title="孙兴毕业设计">内蒙古农业大学</a> 毕业设计2014级 <a   target="_blank">软件工程专业</a></p>
                    </footer>

                </div>
            </div>
        </div>

        <!-- load JS files -->

        <script src="{% static 'js/jquery-1.11.3.min.js' %}"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="{% static 'js/tether.min.js' %}"></script> <!-- Tether for Bootstrap (http://stackoverflow.com/questions/34567939/how-to-fix-the-error-error-bootstrap-tooltips-require-tether-http-github-h) -->
        <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>     <!-- Magnific pop-up (http://dimsemenov.com/plugins/magnific-popup/) -->
        <script src="{% static 'js/jquery.singlePageNav.min.js' %}"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <!-- Templatemo scripts -->
        <script>
            function showName() {
                var test = document.getElementById("test").value;

                document.getElementById("val").value = test;
            }

            function reg() {
                var test = document.getElementById("test").value;

                location.href = '/system/reg/?test=' + test;
            }

            function getoffice() {
            var office=document.getElementById("applyoffice").value;
            document.getElementById("officename").value=office
        }

            function seemessages() {
            $('#modalBody').load('/system/seemessagespanel');
            $('#myModal').modal('show')

        }



        //选择图片，马上预览
        function xmTanUploadImg(obj) {
            var file = obj.files[0];
            console.log(obj);
            console.log(file);
            console.log("file.size = " + file.size);  //file.size 单位为byte
            var reader = new FileReader();
            //读取文件过程方法
            reader.onloadstart = function (e) {
                console.log("开始读取....");
            };
            reader.onprogress = function (e) {
                console.log("正在读取中....");
            };
            reader.onabort = function (e) {
                console.log("中断读取....");
            };
            reader.onerror = function (e) {
                console.log("读取异常....");
            };
            reader.onload = function (e) {
                console.log("成功读取....");
                var img = document.getElementById("xmTanImg");
                img.src = e.target.result;
                //或者 img.src = this.result;  //e.target == this
            };


            reader.readAsDataURL(file)
        }

        function xmTanUploadImg1(obj) {
            var file = obj.files[0];
            console.log(obj);
            console.log(file);
            console.log("file.size = " + file.size);  //file.size 单位为byte
            var reader = new FileReader();
            //读取文件过程方法
            reader.onloadstart = function (e) {
                console.log("开始读取....");
            };
            reader.onprogress = function (e) {
                console.log("正在读取中....");
            };
            reader.onabort = function (e) {
                console.log("中断读取....");
            };
            reader.onerror = function (e) {
                console.log("读取异常....");
            };
            reader.onload = function (e) {
                console.log("成功读取....");
                var img = document.getElementById("xmTanImg1");
                img.src = e.target.result;
                //或者 img.src = this.result;  //e.target == this
            };


            reader.readAsDataURL(file)
        }

            function setNavbar() {
                if ($(document).scrollTop() > 160) {
                    $('.tm-sidebar').addClass('sticky');
                } else {
                    $('.tm-sidebar').removeClass('sticky');
                }
            }

            $(document).ready(function () {

                // Single page nav
                $('.tm-main-nav').singlePageNav({
                    'currentClass': "active",
                    offset: 20
                });

                // Detect window scroll and change navbar
                setNavbar();

                $(window).scroll(function () {
                    setNavbar();
                });

                // Magnific pop up
                $('.tm-gallery').magnificPopup({
                    delegate: 'a', // child items selector, by clicking on it popup will open
                    type: 'image',
                    gallery: {enabled: true}
                    // other options
                });

            });

        </script>


      {#    -------模态框-----------#}
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">

                    <div class="modal-body" id="modalBody">
                        <h1>{{ rs.content }}</h1>
                    </div>

                </div><!-- /.modal-content -->
            </div><!-- /.modal -->
        </div>

        <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">


                    <div class="modal-body" id="modalBody">
                        <img src="/system/createQR/"/>

                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
<!-- 模态框（Modal） -->
     <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-body" id="modalBody">


                </div>

            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    </body>
    </html>